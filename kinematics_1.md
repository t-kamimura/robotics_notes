# 運動学

ロボットアーム（マニピュレータ）の手先を任意の位置に持っていくにはどうすればいいか？

## 2リンクアームの順運動学

まず，リンクの角度を決めたとき，手先がどこにあるのかを考える．
このように，リンクを動かした結果どうなるかを考える問題を**順運動学**と呼ぶ．

第1リンクの長さを$l_1$，第2リンクの長さを$l_2$とする．
それぞれのリンクが$x$軸となす角度を$\theta_1$, $\theta_2$とする．
このとき，手先位置$(X, Y)$は

$$
    X = l_1 \cos\theta_1 + l_2 \cos\theta_2\\
    Y = l_1 \sin\theta_1 + l_2 \sin\theta_2
$$

と表せる．あるいは，第1リンクと第2リンクがなす相対角を$\phi_1$として，

$$
    X = l_1 \cos\theta_1 + l_2 \cos(\theta_1 + \phi_1)\\
    Y = l_1 \sin\theta_1 + l_2 \sin(\theta_1 + \phi_1)
$$

である．第2リンクの絶対角を測定するのは難しいので，実際の運用では（見た目ややこしくなるものの）下の表式を用いることになる．

## 2リンクアームの逆運動学

実際の問題では，手先を動かしたい位置が決まっていて，その位置を実現するようにアームを制御することになる．
このような問題を**逆運動学**と呼ぶ．

手先を$(X,Y)$に動かしたいとして，それを実現する$(\theta_1,\theta_2)$の組，あるいは$(\theta_1,\phi_1)$の組を求める．
結果として，

$$
    \theta_1 = {\rm atan2}(Y,X) \mp {\rm atan2}(\kappa, X^2+Y^2+l_1^2-l_2^2)\\
    \theta_2 = \pm {\rm atan2}(\kappa, X^2+Y^2+l_1^2-l_2^2)
$$

を得る．順運動学と比較して，かなりややこしい計算を必要とすることがわかる．
また，$(X,Y)$を実現するリンクの姿勢は1通りに制限されないこともわかる．

### 逆三角関数atan2

${\rm atan2}$関数は三角関数$\tan$の逆関数であり，

$$
    {\rm atan2} (a,b) = \arg (b + ja)
$$

で定義されるスカラ関数である．ここで$j$は虚数単位，$\arg$は複素数の偏角を表す．

$$
\theta = {\rm atan2}(\sin \theta, \cos\theta)
$$

という関係を覚えておけば便利である．

### 逆運動学の計算

